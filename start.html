<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mechanic 4</title>
<link rel="icon" href="/images/logo/m4-favicon.ico" sizes="any">
<link rel="icon" type="image/png" href="/images/logo/m4-icon.png">
<link rel="apple-touch-icon" href="/images/logo/m4-icon.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#00c300">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="mobile-web-app-capable" content="yes">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&family=Caveat:wght@700&family=Shadows+Into+Light&family=Indie+Flower&family=Patrick+Hand&display=swap" rel="stylesheet">

<style>
* { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
html, body { height: 100%; overflow: hidden; }

html {
    background-color: #00c300;
}

body {
    background-color: #eae9ec;
    display: flex;
    flex-direction: column;
    padding-bottom: env(safe-area-inset-bottom, 0px);
    min-height: 100%;
    min-height: -webkit-fill-available;
}

header {
    background-color: #00c300;
    height: 70px;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    padding: 0 20px;
    position: relative;
}

.header-center {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 8px;
}

.kpn-logo { height: 38px; }

.header-title {
    font-size: 1.3rem;
    font-weight: bold;
    color: #fff;
}

.middle-section {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: visible;
    z-index: 0;
}

.welcome {
    font-size: 2.6rem;
    font-weight: bold;
    color: #222;
    margin-bottom: 0;
}

.knop-wrapper {
    position: relative;
    display: inline-block;
    margin-top: 60px;
}

.start-button {
    display: block;
    padding: 20px 60px;
    font-size: 1.4rem;
    background-color: #00c300;
    color: #fff;
    border: none;
    border-radius: 14px;
    cursor: pointer;
    font-weight: bold;
    box-shadow: 0 6px 20px rgba(0,195,0,0.3);
    animation: pulse 2.5s ease-in-out infinite;
    position: relative;
    z-index: 2;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.start-button.geen-pulse {
    animation: none !important;
    transform: scale(1) !important;
    box-shadow: 0 6px 20px rgba(0,195,0,0.3) !important;
}

@keyframes pulse {
    0%, 100% { transform: scale(1);    box-shadow: 0 6px 20px rgba(0,195,0,0.3); }
    50%       { transform: scale(1.05); box-shadow: 0 8px 25px rgba(0,195,0,0.5); }
}

.start-button:active {
    transform: scale(0.95) !important;
    animation: none;
}

.kat {
    position: fixed;
    font-size: 3.2rem;
    z-index: 10;
    pointer-events: none;
    display: none;
    filter: drop-shadow(0 3px 6px rgba(0,0,0,0.25));
    line-height: 1;
}

.kat-zit {
    position: absolute;
    font-size: 2.4rem;
    top: -38px;
    left: 50%;
    transform: translateX(-50%);
    display: none;
    z-index: 5;
    line-height: 1;
    filter: drop-shadow(0 3px 6px rgba(0,0,0,0.25));
}

/* GRAFFITI CONTAINER */
.graffiti-container {
    position: absolute;
    width: 90%;
    text-align: center;
    pointer-events: none;
    z-index: 3;
    display: none;
}

.graffiti-text {
    font-size: 2.5rem;
    font-weight: bold;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    white-space: nowrap;
    display: inline-block;
    opacity: 0;
}

.graffiti-text.spray-in {
    animation: sprayIn 1.2s ease-out forwards;
}

@keyframes sprayIn {
    0%   { opacity: 0; transform: scale(0.8) translateX(-20px); }
    100% { opacity: 1; transform: scale(1) translateX(0); }
}

/* SPONS */
.spons {
    position: absolute;
    font-size: 3rem;
    z-index: 20;
    pointer-events: none;
    display: none;
    filter: drop-shadow(0 3px 6px rgba(0,0,0,0.25));
}

/* WIPE CANVAS */
.wipe-canvas {
    position: absolute;
    pointer-events: none;
    z-index: 15;
    display: none;
}

.gif-section {
    flex: 0 0 38vh;
    width: 100%;
    overflow: hidden;
    display: flex;
    align-items: flex-end;
    line-height: 0;
    flex-shrink: 0;
}

.gif-section img {
    width: 100%;
    display: block;
}

footer {
    background-color: #00c300;
    color: #fff;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    flex-shrink: 0;
    padding-bottom: env(safe-area-inset-bottom, 0px);
    min-height: calc(55px + env(safe-area-inset-bottom, 0px));
}
</style>
</head>

<body>

<header>
    <div class="header-center">
        <img src="images/logo/kpn-logo.png" class="kpn-logo">
        <span class="header-title">Mechanic 4</span>
    </div>
</header>

<div class="middle-section" id="middleSection">
    <div class="welcome">Hoi Colin,</div>

    <div class="knop-wrapper" id="knopWrapper">
        <span class="kat-zit" id="katZit">üò∏</span>
        <button class="start-button" id="startBtn" onclick="window.location.href='index.html'">Start</button>
    </div>

    <div class="graffiti-container" id="graffitiContainer">
        <div class="graffiti-text" id="graffitiText"></div>
    </div>
    <canvas class="wipe-canvas" id="wipeCanvas"></canvas>
    <div class="spons" id="spons">üßΩ</div>
</div>

<div class="kat" id="kat">üêà</div>

<div class="gif-section">
    <img src="images/mechanics/m4-all.gif" alt="Mechanic4">
</div>

<footer>&copy; KPN 2026</footer>

<script>
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js').catch(e => console.log('SW:', e));
}

// ========== KAT ANIMATIE ==========
const KAT_SPRINGEND = 'üêà';
const KAT_ZITTEND   = ['üò∫', 'üòº', 'üò∏', 'üòπ'];

const katEl    = document.getElementById('kat');
const katZitEl = document.getElementById('katZit');
const startBtn = document.getElementById('startBtn');

let katBezig             = false;
let volgendeKantVanLinks = Math.random() < 0.5;
let emojiWisselInterval  = null;

function wachtEnSpringSoms() {
    const wachttijd = 2000 + Math.random() * 3000;
    setTimeout(startKatAnimatie, wachttijd);
}

function startKatAnimatie() {
    if (katBezig) return;
    katBezig = true;
    startBtn.classList.add('geen-pulse');

    setTimeout(() => {
        const knopRect = startBtn.getBoundingClientRect();
        const doelX = knopRect.left + knopRect.width / 2 - 24;
        const doelY = knopRect.top - 51;

        const vanLinks       = volgendeKantVanLinks;
        volgendeKantVanLinks = !volgendeKantVanLinks;

        const startX     = vanLinks ? -80 : window.innerWidth + 20;
        const boogHoogte = 130 + Math.random() * 80;
        const springDuur = 750 + Math.random() * 200;

        katEl.textContent     = KAT_SPRINGEND;
        katEl.style.display   = 'block';
        katEl.style.left      = startX + 'px';
        katEl.style.top       = doelY + 'px';
        katEl.style.transform = vanLinks ? 'scaleX(-1)' : 'scaleX(1)';

        animeerBoog(startX, doelY, doelX, doelY, boogHoogte, springDuur, vanLinks, () => katLandt(doelX, doelY));
    }, 220);
}

function animeerBoog(x0, y0, x1, y1, boogH, duur, vanLinks, klaar) {
    const start = performance.now();
    function stap(nu) {
        const t  = Math.min((nu - start) / duur, 1);
        const eT = easeInOut(t);
        const x  = x0 + (x1 - x0) * eT;
        const y  = y0 + (y1 - y0) * eT - boogH * 4 * eT * (1 - eT);
        const rotatie  = vanLinks ? -15 + 30 * eT : 15 - 30 * eT;
        const spiegelX = vanLinks ? -1 : 1;
        katEl.style.left      = x + 'px';
        katEl.style.top       = y + 'px';
        katEl.style.transform = `scaleX(${spiegelX}) rotate(${rotatie}deg)`;
        if (t < 1) requestAnimationFrame(stap);
        else klaar();
    }
    requestAnimationFrame(stap);
}

function katLandt(doelX, doelY) {
    const bounceStart = performance.now();
    function bounce(nu) {
        const t       = Math.min((nu - bounceStart) / 220, 1);
        const bounceY = doelY + Math.sin(t * Math.PI) * 10;
        katEl.style.top       = bounceY + 'px';
        katEl.style.transform = 'scaleX(1) rotate(0deg)';
        if (t < 1) {
            requestAnimationFrame(bounce);
        } else {
            katEl.style.top = doelY + 'px';
            setTimeout(() => {
                katEl.style.display    = 'none';
                katZitEl.style.display = 'block';
                katZitEl.textContent   = randomZitEmoji();
                emojiWisselInterval = setInterval(() => {
                    katZitEl.textContent = randomZitEmoji();
                }, 2000);
                const zitTijd = 4000 + Math.random() * 4000;
                setTimeout(() => springWeg(doelX, doelY), zitTijd);
            }, 1000);
        }
    }
    requestAnimationFrame(bounce);
}

function springWeg(doelX, doelY) {
    clearInterval(emojiWisselInterval);
    emojiWisselInterval  = null;
    katZitEl.style.display = 'none';
    katEl.textContent      = KAT_SPRINGEND;
    katEl.style.display    = 'block';
    katEl.style.left       = doelX + 'px';
    katEl.style.top        = doelY + 'px';
    const naarRechts = doelX < window.innerWidth / 2;
    const eindX      = naarRechts ? window.innerWidth + 80 : -100;
    const boogHoogte = 110 + Math.random() * 80;
    const springDuur = 650 + Math.random() * 200;
    katEl.style.transform  = naarRechts ? 'scaleX(-1)' : 'scaleX(1)';
    animeerBoog(doelX, doelY, eindX, doelY - 20, boogHoogte, springDuur, naarRechts, () => {
        katEl.style.display = 'none';
        startBtn.classList.remove('geen-pulse');
        katBezig = false;
        wachtEnSpringSoms();
    });
}

function randomZitEmoji() {
    return KAT_ZITTEND[Math.floor(Math.random() * KAT_ZITTEND.length)];
}

function easeInOut(t) {
    return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;
}

// ========== GRAFFITI ANIMATIE ==========
const GRAFFITI_ZINNEN = [
    'WINNEN WINNEN WINNEN!',
    'TB is het beste',
    'DOEN DOEN DOEN!',
    'TB #1',
    'Mechanic 4'
];

const GRAFFITI_KLEUREN = ['#FF6B35', '#F7931E', '#00D9FF', '#FF00FF', '#7FFF00', '#FFD700'];
const GRAFFITI_FONTS = ['Permanent Marker', 'Caveat', 'Shadows Into Light', 'Indie Flower', 'Patrick Hand'];
const GRAFFITI_POSITIES = [
    { transform: 'rotate(-3deg) translateY(-10px)' },   // diagonal omhoog
    { transform: 'rotate(3deg) translateY(10px)' },     // diagonal omlaag
    { transform: 'rotate(0deg) translateY(0)' },        // horizontaal
    { transform: 'rotate(-2deg) translateY(-5px)' },    // licht omhoog
    { transform: 'rotate(2deg) translateY(5px)' }       // licht omlaag
];

const graffitiContainer = document.getElementById('graffitiContainer');
const graffitiText = document.getElementById('graffitiText');
const spons = document.getElementById('spons');
const wipeCanvas = document.getElementById('wipeCanvas');
const middleSection = document.getElementById('middleSection');

let graffitiBezig = false;
let vorigeZin = null;

function wachtEnSprayGraffiti() {
    const wachttijd = 2000 + Math.random() * 3000;
    setTimeout(startGraffitiAnimatie, wachttijd);
}

function startGraffitiAnimatie() {
    if (graffitiBezig) return;
    graffitiBezig = true;

    // Kies random zin (niet dezelfde als vorige)
    let zin;
    do {
        zin = GRAFFITI_ZINNEN[Math.floor(Math.random() * GRAFFITI_ZINNEN.length)];
    } while (zin === vorigeZin && GRAFFITI_ZINNEN.length > 1);
    vorigeZin = zin;

    // Kies random kleur, font, positie
    const kleur = GRAFFITI_KLEUREN[Math.floor(Math.random() * GRAFFITI_KLEUREN.length)];
    const font = GRAFFITI_FONTS[Math.floor(Math.random() * GRAFFITI_FONTS.length)];
    const positie = GRAFFITI_POSITIES[Math.floor(Math.random() * GRAFFITI_POSITIES.length)];

    // Positioneer container tussen button en GIF
    const knopRect = startBtn.getBoundingClientRect();
    const gifRect = document.querySelector('.gif-section').getBoundingClientRect();
    const beschikbareRuimte = gifRect.top - knopRect.bottom;
    const centerY = knopRect.bottom + (beschikbareRuimte / 2);

    graffitiContainer.style.top = centerY + 'px';
    graffitiContainer.style.left = '50%';
    graffitiContainer.style.transform = 'translate(-50%, -50%)';

    // Style tekst
    graffitiText.textContent = zin;
    graffitiText.style.color = kleur;
    graffitiText.style.fontFamily = `'${font}', cursive`;
    graffitiText.style.transform = positie.transform;
    graffitiText.style.opacity = '0';

    // Toon en spray
    graffitiContainer.style.display = 'block';
    setTimeout(() => {
        graffitiText.classList.add('spray-in');
        graffitiText.style.opacity = '1';
    }, 50);

    // Laat graffiti staan 3-5 seconden
    const staanTijd = 3000 + Math.random() * 2000;
    setTimeout(() => veegGraffitiWeg(), staanTijd + 1200);
}

function veegGraffitiWeg() {
    const containerRect = graffitiContainer.getBoundingClientRect();
    const textRect = graffitiText.getBoundingClientRect();

    // Setup canvas
    const ctx = wipeCanvas.getContext('2d');
    wipeCanvas.width = window.innerWidth;
    wipeCanvas.height = window.innerHeight;
    wipeCanvas.style.display = 'block';

    // Random richting
    const vanLinks = Math.random() < 0.5;
    const startX = vanLinks ? -60 : window.innerWidth + 20;
    const eindX = vanLinks ? window.innerWidth + 60 : -60;

    spons.style.display = 'block';
    spons.style.left = startX + 'px';
    spons.style.top = containerRect.top + 'px';

    const duur = 1800;
    const startTijd = performance.now();

    function animeerSpons(nu) {
        const verstreken = nu - startTijd;
        const voortgang = Math.min(verstreken / duur, 1);

        // Spons positie met scrub wiggle
        const x = startX + (eindX - startX) * voortgang;
        const wiggle = Math.sin(voortgang * Math.PI * 8) * 8;
        const y = containerRect.top + wiggle;

        spons.style.left = x + 'px';
        spons.style.top = y + 'px';

        // Teken wipe overlay
        ctx.fillStyle = '#eae9ec';
        if (vanLinks) {
            ctx.fillRect(0, containerRect.top - 30, x + 50, 100);
        } else {
            ctx.fillRect(x - 10, containerRect.top - 30, window.innerWidth, 100);
        }

        if (voortgang < 1) {
            requestAnimationFrame(animeerSpons);
        } else {
            // Cleanup
            spons.style.display = 'none';
            wipeCanvas.style.display = 'none';
            graffitiContainer.style.display = 'none';
            graffitiText.classList.remove('spray-in');
            ctx.clearRect(0, 0, wipeCanvas.width, wipeCanvas.height);
            graffitiBezig = false;
            wachtEnSprayGraffiti();
        }
    }
    requestAnimationFrame(animeerSpons);
}

// Start beide animaties
wachtEnSpringSoms();
wachtEnSprayGraffiti();
</script>

</body>
</html>
